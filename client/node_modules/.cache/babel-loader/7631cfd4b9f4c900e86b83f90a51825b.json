{"ast":null,"code":"var _jsxFileName = \"/Users/emilyungos/Desktop/fotoshoppe/client/src/components/products.js\";\nimport React, { Component } from \"react\";\nimport { getProducts } from \"../services/prodService\";\nimport { getGenres } from \"../services/catService\";\nimport { paginate } from \"../utils/paginate\";\nimport ProductsTable from \"./productsTable\";\nimport ListGroup from \"./common/listGroup\";\nimport Pagination from \"./common/pagination\";\nimport SearchProduct from \"./searchProduct\";\nimport _ from \"lodash\";\nimport \"./css/products.css\";\n\nclass Products extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      products: [],\n      genres: [],\n      currentPage: 1,\n      searchQuery: \"\",\n      selectedGenre: null,\n      pageSize: 5,\n      sortColumn: {\n        path: \"title\",\n        order: \"asc\"\n      }\n    };\n\n    this.handleDelete = product => {\n      const products = this.state.products.filter(p => p._id !== product._id);\n      this.setState({\n        products\n      });\n    };\n\n    this.handleLike = product => {\n      const products = [...this.state.products];\n      const index = products.indexOf(product);\n      products[index] = { ...products[index]\n      };\n      products[index].liked = !products[index].liked;\n      this.setState({\n        products\n      });\n    };\n\n    this.handlePageChange = page => {\n      this.setState({\n        currentPage: page\n      });\n    };\n\n    this.handleGenreSelect = genre => {\n      this.setState({\n        selectedGenre: genre,\n        searchQuery: \"\",\n        currentPage: 1\n      });\n    };\n\n    this.handleSearch = query => {\n      this.setState({\n        searchQuery: query,\n        selectedGenre: null,\n        currentPage: 1\n      });\n    };\n\n    this.handleSort = sortColumn => {\n      this.setState({\n        sortColumn\n      });\n    };\n\n    this.getPagedData = () => {\n      const {\n        pageSize,\n        currentPage,\n        selectedGenre,\n        searchQuery,\n        sortColumn,\n        products: allProducts\n      } = this.state;\n      let filtered = allProducts;\n      if (searchQuery) filtered = allProducts.filter(p => p.title.toLowerCase().startsWith(searchQuery.toLowerCase()));else if (selectedGenre && selectedGenre._id) filtered = allProducts.filter(p => p.genre._id === selectedGenre._id);\n\n      const sorted = _.orderBy(filtered, [sortColumn.path], [sortColumn.order]);\n\n      const products = paginate(sorted, currentPage, pageSize);\n      return {\n        totalCount: filtered.length,\n        data: products\n      };\n    };\n  }\n\n  // fetch all products\n  async componentDidMount() {\n    const {\n      data\n    } = await getGenres();\n    const genres = [{\n      _id: \"\",\n      name: \"All Products\"\n    }, ...data];\n    const {\n      data: products\n    } = await getProducts();\n    this.setState({\n      products,\n      genres: genres\n    });\n  }\n\n  render() {\n    const {\n      length: count\n    } = this.state.products;\n    const {\n      pageSize,\n      currentPage,\n      sortColumn,\n      searchQuery\n    } = this.state; // this will run if there is no product displayed on the page\n\n    if (count === 0) return /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        textAlign: \"center\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }\n    }, \"There are no products in the database...\");\n    const {\n      totalCount,\n      data: products\n    } = this.getPagedData();\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(SearchProduct, {\n      value: searchQuery,\n      onChange: this.handleSearch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img-fluid cover\",\n      src: \"assets/cover.jpg\",\n      alt: \"Responsive image\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img-fluid cover\",\n      src: \"assets/cover2.jpg\",\n      alt: \"Responsive image\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      id: \"copy\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 15\n      }\n    }, \"\\xA9\"), \"2020 Fotoshoppe\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(ListGroup, {\n      items: this.state.genres,\n      selectedItem: this.state.selectedGenre,\n      onItemSelect: this.handleGenreSelect,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        marginBottom: \"50px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 13\n      }\n    }, \"Showing \", totalCount, \" products in total...\"), /*#__PURE__*/React.createElement(ProductsTable, {\n      products: products,\n      sortColumn: sortColumn,\n      onLike: this.handleLike,\n      onDelete: this.handleDelete,\n      onSort: this.handleSort,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(Pagination, {\n      itemsCount: totalCount,\n      pageSize: pageSize,\n      currentPage: currentPage,\n      onPageChange: this.handlePageChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 13\n      }\n    }))));\n  }\n\n}\n\nexport default Products;","map":{"version":3,"sources":["/Users/emilyungos/Desktop/fotoshoppe/client/src/components/products.js"],"names":["React","Component","getProducts","getGenres","paginate","ProductsTable","ListGroup","Pagination","SearchProduct","_","Products","state","products","genres","currentPage","searchQuery","selectedGenre","pageSize","sortColumn","path","order","handleDelete","product","filter","p","_id","setState","handleLike","index","indexOf","liked","handlePageChange","page","handleGenreSelect","genre","handleSearch","query","handleSort","getPagedData","allProducts","filtered","title","toLowerCase","startsWith","sorted","orderBy","totalCount","length","data","componentDidMount","name","render","count","textAlign","marginBottom"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { getProducts } from \"../services/prodService\";\nimport { getGenres } from \"../services/catService\";\nimport { paginate } from \"../utils/paginate\";\nimport ProductsTable from \"./productsTable\";\nimport ListGroup from \"./common/listGroup\";\nimport Pagination from \"./common/pagination\";\nimport SearchProduct from \"./searchProduct\";\nimport _ from \"lodash\";\nimport \"./css/products.css\";\n\nclass Products extends Component {\n  state = {\n    products: [],\n    genres: [],\n    currentPage: 1,\n    searchQuery: \"\",\n    selectedGenre: null,\n    pageSize: 5,\n    sortColumn: { path: \"title\", order: \"asc\" },\n  };\n\n  // fetch all products\n  async componentDidMount() {\n    const { data } = await getGenres();\n    const genres = [{ _id: \"\", name: \"All Products\" }, ...data];\n\n    const { data: products } = await getProducts();\n    this.setState({ products, genres: genres });\n  };\n\n  // deletes a product\n  handleDelete = (product) => {\n    const products = this.state.products.filter((p) => p._id !== product._id);\n    this.setState({ products });\n  };\n\n  // for adding a product to a wishlist in the future\n  handleLike = (product) => {\n    const products = [...this.state.products];\n    const index = products.indexOf(product);\n    products[index] = { ...products[index] };\n    products[index].liked = !products[index].liked;\n    this.setState({ products });\n  };\n\n  // displaying products by page\n  handlePageChange = (page) => {\n    this.setState({ currentPage: page });\n  };\n\n  // displaying products by category\n  handleGenreSelect = (genre) => {\n    this.setState({ selectedGenre: genre, searchQuery: \"\", currentPage: 1 });\n  };\n\n  // searching a product\n  handleSearch = (query) => {\n    this.setState({ searchQuery: query, selectedGenre: null, currentPage: 1 });\n  };\n\n  // displaying products by asc or desc order\n  handleSort = (sortColumn) => {\n    this.setState({ sortColumn });\n  };\n\n  getPagedData = () => {\n    const {\n      pageSize,\n      currentPage,\n      selectedGenre,\n      searchQuery,\n      sortColumn,\n      products: allProducts,\n    } = this.state;\n\n    let filtered = allProducts;\n    if (searchQuery)\n      filtered = allProducts.filter((p) =>\n        p.title.toLowerCase().startsWith(searchQuery.toLowerCase())\n      );\n    else if (selectedGenre && selectedGenre._id)\n      filtered = allProducts.filter((p) => p.genre._id === selectedGenre._id);\n\n    const sorted = _.orderBy(filtered, [sortColumn.path], [sortColumn.order]);\n\n    const products = paginate(sorted, currentPage, pageSize);\n\n    return { totalCount: filtered.length, data: products };\n  };\n\n  render() {\n    const { length: count } = this.state.products;\n    const { pageSize, currentPage, sortColumn, searchQuery } = this.state;\n\n    // this will run if there is no product displayed on the page\n    if (count === 0)\n      return (\n        <p style={{ textAlign: \"center\" }}>\n          There are no products in the database...\n        </p>\n      );\n\n    const { totalCount, data: products } = this.getPagedData();\n    return (\n      <div className=\"container-fluid text-center\">\n        <div className=\"row\">\n          <div className=\"col-3\">\n            <SearchProduct value={searchQuery} onChange={this.handleSearch} />\n            <img\n              className=\"img-fluid cover\"\n              src=\"assets/cover.jpg\"\n              alt=\"Responsive image\"\n            />\n            <img\n              className=\"img-fluid cover\"\n              src=\"assets/cover2.jpg\"\n              alt=\"Responsive image\"\n            />\n            <p id=\"copy\">\n              <span>&#169;</span>2020 Fotoshoppe\n            </p>\n          </div>\n          <div className=\"col\">\n            <ListGroup\n              items={this.state.genres}\n              selectedItem={this.state.selectedGenre}\n              onItemSelect={this.handleGenreSelect}\n            />\n            <p style={{ marginBottom: \"50px\" }}>\n              Showing {totalCount} products in total...\n            </p>\n            <ProductsTable\n              products={products}\n              sortColumn={sortColumn}\n              onLike={this.handleLike}\n              onDelete={this.handleDelete}\n              onSort={this.handleSort}\n            />\n            <Pagination\n              itemsCount={totalCount}\n              pageSize={pageSize}\n              currentPage={currentPage}\n              onPageChange={this.handlePageChange}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Products;\n"]},"metadata":{},"sourceType":"module"}